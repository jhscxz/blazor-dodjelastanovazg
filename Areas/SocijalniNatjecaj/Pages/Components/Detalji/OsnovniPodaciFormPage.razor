@page "/socijalni/osnovno/edit/{ZahtjevId:long}"
@using System.Globalization
@using DodjelaStanovaZG.Components.UI
@using MudBlazor
@using DodjelaStanovaZG.Enums
@using Microsoft.AspNetCore.Components.Web

<PageTitle>Uredi osnovne podatke</PageTitle>

<Container BreadcrumbItems="BreadcrumbItems">
    <MudContainer MaxWidth="MaxWidth.Small">
        @if (_socijalniNatjecajModel is null)
        {
            <MudProgressCircular Color="Color.Primary" Indeterminate="true" />
        }
        else
        {
            <MudCard Outlined="true" Rounded="true" Class="pa-6 border border-gray-300">
                <MudCardContent>
                    <!-- Display error messages -->
                    @if (ErrorMessages?.Any() == true)
                    {
                        <MudAlert Severity="Severity.Error" Class="mb-4">
                            <ul>
                                @foreach (var msg in ErrorMessages)
                                {
                                    <li>@msg</li>
                                }
                            </ul>
                        </MudAlert>
                    }

                    <!-- Form content -->
                    <MudForm @ref="_form" Model="@_socijalniNatjecajModel" OnValidSubmit="OnValidSubmit">
                        <MudGrid Gutter="Size.Small">
                            <MudItem xs="12" sm="6">
                                <MudTextField T="int?"
                                              Label="Klasa predmeta"
                                              @bind-Value="_socijalniNatjecajModel.KlasaPredmeta"
                                              Required="true"
                                              Variant="Variant.Outlined"
                                              Margin="Margin.Dense"
                                              ShrinkLabel="true"
                                              Class="mb-4" />
                            </MudItem>
                            <MudItem xs="12" sm="6">
                                <MudDatePicker ShrinkLabel T="DateTime?"
                                               Label="Datum podnoÅ¡enja zahtjeva"
                                               @bind-Date="_datumPodnosenja"
                                               Required="true"
                                               DateFormat="dd.MM.yyyy"
                                               Culture="@(new CultureInfo("hr-HR"))"
                                               Variant="Variant.Outlined"
                                               Margin="Margin.Dense"
                                               Clearable="true"
                                               Class="mb-4" />
                            </MudItem>
                        </MudGrid>

                        <MudTextField ShrinkLabel T="string?"
                                      Label="Adresa"
                                      @bind-Value="_socijalniNatjecajModel.Adresa"
                                      Variant="Variant.Outlined"
                                      Margin="Margin.Dense"
                                      Class="mb-4" />

                        <MudStack Class="mt-4 mb-6">
                            <MudToggleGroup T="int?" SelectionMode="SelectionMode.ToggleSelection"
                                            @bind-Value="_toggleRezultat"
                                            Color="Color.Default"
                                            CheckMark>
                                <MudToggleItem Value="@((int?)RezultatObrade.Nepotpun)" Text="NEPOTPUN" />
                                <MudToggleItem Value="@((int?)RezultatObrade.Neosnovan)" Text="NEOSNOVAN" />
                                <MudToggleItem Value="@((int?)RezultatObrade.Zadovoljava)" Text="ZADOVOLJAVA" />
                            </MudToggleGroup>
                        </MudStack>

                        <MudItem xs="12">
                            <MudTextField ShrinkLabel T="string"
                                          Label="Napomena obrade"
                                          @bind-Value="_socijalniNatjecajModel.NapomenaObrade"
                                          Variant="Variant.Outlined"
                                          Margin="Margin.Dense"
                                          Class="mb-4"
                                          Lines="3" />
                        </MudItem>

                        <MudStack Row="true" Justify="Justify.FlexEnd" Spacing="2" Class="mt-4">
                            <MudButton OnClick="@OnValidSubmit"
                                       StartIcon="@Icons.Material.Filled.Save"
                                       Size="Size.Small"
                                       Variant="Variant.Filled"
                                       Style="border: 1px solid #d3d3d3;"
                                       DropShadow="false"
                                       IconColor="Color.Success"
                                       Color="Color.Default">
                                Spremi
                            </MudButton>

                            <MudButton OnClick="@OnCancel"
                                       StartIcon="@Icons.Material.Filled.Cancel"
                                       Size="Size.Small"
                                       DropShadow="false"
                                       Style="border: 1px solid #d3d3d3;"
                                       Variant="Variant.Filled"
                                       IconColor="Color.Error"
                                       Color="Color.Default">
                                Odustani
                            </MudButton>
                        </MudStack>

                    </MudForm>
                </MudCardContent>
            </MudCard>
        }
    </MudContainer>
</Container>

@page "/socijalni/detalji/prikaz/{Id:long}"
@using DodjelaStanovaZG.Areas.SocijalniNatjecaj.DTO
@using DodjelaStanovaZG.Enums
@using DodjelaStanovaZG.Components.UI.MudInputs
@using MudBlazor
@inject NavigationManager Navigation

@code {
    [Parameter]
    public long Id { get; set; }

    [Parameter]
    public SocijalniNatjecajZahtjevDto Detalji { get; set; } = new();
}

<MudStack Spacing="4">

    <!-- MudCard -->
    <MudCard Outlined="true" Class="pa-4">

        <!-- Klasa predmeta i Datum podnošenja -->
        <MudGrid Gutter="Size.Small">
            <MudItem xs="12" sm="6">
                <TextInput T="string"
                           Label="Klasa predmeta"
                           Value="@Detalji.KlasaPredmeta?.ToString()"
                           ReadOnly="true" />
            </MudItem>
            <MudItem xs="12" sm="6">
                <TextInput T="string"
                           Label="Datum podnošenja zahtjeva"
                           Value="@Detalji.DatumPodnosenjaZahtjeva?.ToString("dd.MM.yyyy")"
                           ReadOnly="true" />
            </MudItem>
        </MudGrid>

        <!-- Adresa -->
        <TextInput T="string"
                   Label="Adresa"
                   Value="@Detalji.Adresa"
                   ReadOnly="true" />

        <!-- E-mail -->
        <TextInput T="string"
                   Label="Email podnositelja"
                   Value="@Detalji.Email"
                   ReadOnly="true" />

        <!-- Napomena obrade -->
        <TextAreaInput Label="Napomena obrade"
                       Value="@Detalji.NapomenaObrade"
                       ReadOnly="true"
                       Class="mb-4" />
    </MudCard>

    <!-- Chip + Uredi gumb -->
    <MudStack Spacing="2" Row="true" Justify="Justify.SpaceBetween">
        <MudChip T="string"
                 Variant="@ChipVariant"
                 Color="@ChipColor"
                 Size="Size.Small"
                 StartIcon="@ChipIcon"
                 Class="px-2 py-1 rounded-sm">
            @ChipText
        </MudChip>

        <MudButton StartIcon="@Icons.Material.Filled.Edit"
                   Variant="Variant.Filled"
                   Size="Size.Small"
                   Style="border: 1px solid #d3d3d3;"
                   DropShadow="false"
                   IconColor="Color.Info"
                   Color="Color.Default"
                   OnClick="@(() => Navigation.NavigateTo($"/socijalni/osnovno/edit/{Detalji.Id}"))">
            Uredi osnovne podatke
        </MudButton>
    </MudStack>

</MudStack>

@code {
    private Color ChipColor => Detalji.RezultatObrade switch
    {
        RezultatObrade.Neosnovan => Color.Error,
        RezultatObrade.Nepotpun => Color.Warning,
        RezultatObrade.Zadovoljava => Color.Success,
        _ => Color.Default
    };

    private string ChipIcon => Detalji.RezultatObrade switch
    {
        RezultatObrade.Neosnovan => Icons.Material.Filled.Dangerous,
        RezultatObrade.Nepotpun => Icons.Material.Filled.Warning,
        RezultatObrade.Zadovoljava => Icons.Material.Filled.CheckCircle,
        _ => Icons.Material.Filled.Info
    };

    private string ChipText => Detalji.RezultatObrade switch
    {
        RezultatObrade.Neosnovan => "Neosnovan",
        RezultatObrade.Nepotpun => "Nepotpuno",
        RezultatObrade.Zadovoljava => "Ispunjava uvjete",
        _ => "Nepoznato"
    };

    private Variant ChipVariant => Detalji.RezultatObrade == RezultatObrade.Zadovoljava
        ? Variant.Outlined
        : Variant.Text;
}

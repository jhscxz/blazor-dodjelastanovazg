@typeparam T
@using System.Linq.Expressions
@using MudBlazor

<MudTextField T="T"
              @bind-Value="CurrentValue"
              @bind-ValueExpression="ValueExpression"
              Label="@Label"
              Variant="@Variant"
              Margin="@Margin"
              Required="@Required"
              InputType="InputType.Text"
              Lines="@Lines"
              ShrinkLabel="@ShrinkLabel"
              ReadOnly="@ReadOnly"
              Adornment="@Adornment"
              AdornmentText="@AdornmentText"
              Class="@Class"
              @attributes="AdditionalAttributes" />

@code {
    [Parameter] public T? Value { get; set; }
    [Parameter] public EventCallback<T?> ValueChanged { get; set; }
    [Parameter] public Expression<Func<T?>>? ValueExpression { get; set; }

    [Parameter] public string Label { get; set; } = string.Empty;
    [Parameter] public bool Required { get; set; } = false;
    [Parameter] public int Lines { get; set; } = 1;
    [Parameter] public bool ShrinkLabel { get; set; } = true;
    [Parameter] public Variant Variant { get; set; } = Variant.Text;
    [Parameter] public Margin Margin { get; set; } = Margin.Dense;
    [Parameter] public bool ReadOnly { get; set; } = false;
    [Parameter] public string Class { get; set; } = string.Empty;

    [Parameter] public Adornment Adornment { get; set; } = Adornment.End;
    [Parameter] public string? AdornmentText { get; set; } = "â‚¬";

    [Parameter(CaptureUnmatchedValues = true)]
    public Dictionary<string, object>? AdditionalAttributes { get; set; }

    private T? CurrentValue
    {
        get => Value;
        set
        {
            if (EqualityComparer<T?>.Default.Equals(Value, value)) return;
            Value = value;
            ValueChanged.InvokeAsync(value);
        }
    }
}